# Config file for - http://www.appveyor.com/
# Ref - http://www.appveyor.com/docs/appveyor-yml
# Validate here - https://ci.appveyor.com/tools/validate-yaml

version: 1.0.{build}-{branch}

# Test against this version of Node.js
environment:
  nodejs_version: "0.12"

# set git clone depth
clone_depth: 1                      # clone entire repository history if not defined

# Install scripts. (runs after repo cloning)
install:
    # Get the latest stable version of Node.js or io.js
    - ps: Install-Product node $env:nodejs_version x86
    # Update npm itself
    - npm install -g npm
    # Install node packages
    - npm install
    # Install bower
    - npm install -g bower
    # Install gulp
    - npm install -g gulp
    # Download bower packages
    - bower install
    # download inno setup installer , http://www.appveyor.com/docs/how-to/download-file
    - ps: Start-FileDownload "http://www.jrsoftware.org/download.php/is.exe"
    - cmd: dir /b
    # silent install inno setup
    - cmd: is.exe /SP- /VERYSILENT /SUPPRESSMSGBOXES /NORESTART /NOCANCEL


# Post-install test scripts.
test_script:
  # Output useful info for debugging.
  - node --version
  - npm --version
  - echo %CD%
  - cmd: dir /b
  # run gulp tasks
  - npm run-script gulp-dist
  - npm run-script gulp-build
  - npm run-script gulp-release
  - cmd: dir /b C:\projects\node-webkit-angular-starter-kit


# Cache folder to speed up builds
cache:
  - node_modules -> package.json # preserve "node_modules" directory in the root of build folder but will reset it if package.json is modified
  - app/node_modules -> app\package.json
  - app/bower_components -> bower.json
  - cache   # nw-builder cache
  - '%APPDATA%\npm-cache'   # npm cache

# which git branch to watch
branches:
  only:
    - master

# Do not build on tags (GitHub only)
skip_tags: true

# Don't actually build.
build: off

# Turn off test scripts
#test: off
